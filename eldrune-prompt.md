The app will be the game master for a table top role playing game. It will use the rules from Daggerheat. 
Daggerheart is a herioc adventure ttrpg with a focus on narrative and free flowing combat. 
The manuscript for the daggerheart rules will be provided as a pdf file. The app must create an engaging, coherent and enjoyable experience for the human players. 

The app must have the following components: 
Core Engine, 
AI Agents, 
Data Layer and 
User Interface. 

The Core Engine is responsible for coordinating interaction between various AI agents, managing state and memory, and handling player interactions. 

The AI Agents are responsible for different aspects, such as narrator agent, historian agent, writer agent and custodian agent. The narrator agent is responsible generating immersive narratives based on the world's state, players' actions, and historical context. The narrator agent uses a blend of natural language processing (NLP) and dynamic storytelling to create engaging descriptions of scenes, events, and character interactions. The writer agent must simulate elements of the game world, such as NPC behavior, environmental conditions, and in-game systems (e.g., economy, politics). The writer agent must use the historical context, world's state and player interactions dynamically, updating the world state based on outcomes. The writer agent is responsible for creating maps, locations, factions, established lore, etc. The custodian agent is responsible for keeping track of individual players. The custodian agent must recognise their voice and tweak interactions based on player specific feedback. The custodian agent must also keep track of themes specific players want to avoid so that the narrator agent and writer agent does not introduce sensitive topics. The historian agent is responsible keeping track of the storyline, character backstories, npc character arcs, story arcs, and significant world events to maintain continuity. It tracks story arcs, character relationships, and plot threads to help the writer agent weave consistent narratives over time. It maintains “world memory,” updating with key events, player interactions, and NPC (Non-Player Character) histories. The historian agent will provide the current world state. The historian agent's world memory will help ensures logical progression in storylines by referencing past events, established lore, and character relationships. 

The Data Layer is a World Database that stores the history of everything, including locations, items, factions, lore elements, NPCs and their history and their character arcs, as well as player-specific data, including player preferences, player character data, and game history. This database must support persistent sessions, allowing players to pick up where they left off, even after long breaks. The game flow must be as follows: Each session must start with players joining the session, where the custodian agent identifies each participant. The History Agent provides a quick recap of the storyline so far, allowing players to reconnect with the narrative. After the session introduction the play will consist of several consecutive scenes. For each scene the Narrator agent will set the scene with a description, providing context based on the current world state and ask the players what they want to do next. The writer agent will resolve the players requests with follow up questions for any required clarification and update the environment and NPC state and world state based on players responses. At the end of each session, players provide feedback to the custodian agent, which the custodian agent uses to improve narrative flow, world-building, and gameplay mechanics. Machine learning models analyze player interactions and preferences to refine and personalize future game sessions. 

The User interface consists of a Game dashboard and Voice and Text Interaction Module. The Game Dashboard shows current scene descriptions, character stats, and relevant NPC or world information and maps. Voice and Text Interaction Module allows players to communicate with AI agents through speech or typing, creating an accessible and immersive experience.

